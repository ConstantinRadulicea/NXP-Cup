#ifndef __ESC_RAW_H__
#define __ESC_RAW_H__


float _raw_to_rpm_correlation[] = {
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.000000, 0.05, 0.06, 0.07, 10.0, 20.0, 30.0, 41.268178, 63.191766, 85.537963,
    85.806631, 106.268948, 124.875742, 143.577924, 162.216347, 162.230547, 180.052048, 198.308913, 217.648165, 217.673154,
    236.120701, 253.508887, 273.630239, 291.235132, 291.245026, 308.053384, 326.352926, 345.213629, 345.222278, 363.463742,
    380.038831, 399.149850, 415.995755, 416.087696, 436.520831, 453.486184, 470.283477, 489.376310, 489.389492, 506.302098,
    524.500544, 540.823345, 541.014965, 559.714497, 576.856861, 595.526751, 612.213106, 612.292473, 629.100007, 648.567514,
    664.235367, 664.244937, 683.507430, 701.468972, 719.575898, 736.873692, 737.048941, 755.142570, 773.265295, 790.321770,
    808.758777, 808.763581, 826.887753, 845.545735, 861.441564, 861.789351, 881.226612, 898.080063, 916.189544, 932.031978,
    932.106692, 948.285894, 966.277813, 983.434542, 984.867976, 1000.694551, 1018.244176, 1035.225217, 1051.371970, 1051.389568,
    1068.399633, 1084.194117, 1099.736965, 1116.797466, 1117.127399, 1133.217165, 1149.547965, 1164.443898, 1164.755705, 1183.627447,
    1187.775371
};


static float rawToRpm(float raw_value) {
    return _raw_to_rpm_correlation[(unsigned int)raw_value];
}

static float RpmToRaw(float rpm) {
    int len = (sizeof(_raw_to_rpm_correlation) / sizeof(*_raw_to_rpm_correlation));
    int i = 0;
    if (rpm >= -1) {
        i = 90;
    }
    for (i; i < (len - 1); i++)
    {
        if (rpm >= _raw_to_rpm_correlation[i] && rpm < _raw_to_rpm_correlation[i + 1]) {
            return (float)i;
        }
    }

    if (rpm >= _raw_to_rpm_correlation[len - 1]) {
        return len - 1;
    }
    else {
        return 0.0;
    }
}

static float RpmToThrottle(float rpm) {
    return (RpmToRaw(rpm) - 90.0) / 90.0;
}

#endif